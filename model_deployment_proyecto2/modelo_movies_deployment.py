#!/usr/bin/python

import pandas as pd
import joblib
import sys
import os
from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.linear_model import RidgeClassifier

def predict_genres(plot):
    
    clf = joblib.load(os.path.dirname(__file__) + '/movies_clf.pkl') 
    
    vect = CountVectorizer(max_features=1000)
    
    vect.vocabulary_ = {'most': 581,
                         'is': 444,
                         'the': 868,
                         'story': 827,
                         'of': 615,
                         'single': 791,
                         'father': 302,
                         'who': 967,
                         'takes': 850,
                         'his': 408,
                         'year': 993,
                         'old': 622,
                         'son': 804,
                         'to': 889,
                         'work': 984,
                         'with': 978,
                         'him': 404,
                         'at': 64,
                         'where': 962,
                         'he': 390,
                         'day': 209,
                         'before': 87,
                         'boy': 118,
                         'meets': 559,
                         'woman': 981,
                         'train': 902,
                         'drug': 251,
                         'goes': 369,
                         'into': 439,
                         'room': 737,
                         'and': 41,
                         'tells': 862,
                         'stay': 819,
                         'ship': 782,
                         'comes': 177,
                         'though': 882,
                         'it': 448,
                         'arrive': 56,
                         'an': 40,
                         'later': 492,
                         'happens': 383,
                         'sees': 766,
                         'this': 880,
                         'tries': 907,
                         'not': 611,
                         'able': 0,
                         'see': 759,
                         'just': 467,
                         'as': 60,
                         'falls': 296,
                         'works': 986,
                         'while': 965,
                         'leaving': 504,
                         'then': 872,
                         'people': 649,
                         'in': 431,
                         'are': 51,
                         'fact': 293,
                         'died': 229,
                         'trying': 914,
                         'save': 748,
                         'them': 870,
                         'other': 632,
                         'than': 866,
                         'happened': 382,
                         'look': 523,
                         'out': 635,
                         'her': 399,
                         'movie': 585,
                         'ends': 268,
                         'man': 542,
                         'new': 604,
                         'city': 165,
                         'no': 609,
                         'small': 796,
                         'baby': 72,
                         'run': 740,
                         'one': 626,
                         'female': 308,
                         'they': 875,
                         'all': 29,
                         'meet': 557,
                         'film': 314,
                         'killer': 476,
                         'decides': 218,
                         'secrets': 757,
                         'career': 145,
                         'store': 825,
                         'lives': 516,
                         'beyond': 100,
                         'means': 555,
                         'become': 83,
                         'she': 780,
                         'love': 532,
                         'life': 510,
                         'changes': 153,
                         'when': 961,
                         'be': 80,
                         'wife': 972,
                         'apartment': 49,
                         'but': 132,
                         'believes': 94,
                         'rather': 699,
                         'offers': 618,
                         'chance': 151,
                         'like': 512,
                         'again': 16,
                         'accepts': 2,
                         'despite': 223,
                         'meanwhile': 556,
                         'evil': 287,
                         'himself': 405,
                         'person': 651,
                         'way': 950,
                         'fortune': 336,
                         'four': 338,
                         'york': 996,
                         'president': 676,
                         'has': 387,
                         'had': 378,
                         'meeting': 558,
                         'sends': 769,
                         'six': 794,
                         'never': 603,
                         'for': 329,
                         'after': 15,
                         'death': 216,
                         'getting': 359,
                         'dies': 230,
                         'on': 624,
                         'street': 830,
                         'get': 357,
                         'money': 577,
                         'body': 112,
                         'without': 980,
                         'george': 355,
                         'from': 346,
                         'use': 932,
                         'information': 434,
                         'make': 539,
                         'sell': 768,
                         'much': 588,
                         'possible': 670,
                         'until': 928,
                         'end': 267,
                         'back': 73,
                         'morning': 580,
                         'by': 134,
                         'making': 541,
                         'learn': 500,
                         'that': 867,
                         'dead': 212,
                         'company': 180,
                         'next': 606,
                         'seven': 775,
                         'member': 560,
                         'board': 108,
                         'however': 421,
                         'don': 243,
                         'there': 873,
                         'position': 669,
                         'walter': 943,
                         'married': 547,
                         'needs': 600,
                         'give': 363,
                         'if': 428,
                         'near': 598,
                         'close': 168,
                         'friend': 343,
                         'will': 974,
                         'responsible': 719,
                         'los': 527,
                         'angeles': 42,
                         'house': 419,
                         'date': 205,
                         'lawyer': 495,
                         'michael': 566,
                         'powerful': 672,
                         'accidentally': 4,
                         'murder': 589,
                         'robert': 731,
                         'discover': 234,
                         'chief': 158,
                         'martin': 549,
                         'head': 391,
                         'convince': 184,
                         'against': 17,
                         'murdered': 590,
                         'take': 848,
                         'three': 884,
                         'find': 317,
                         'kill': 474,
                         'do': 236,
                         'know': 481,
                         'does': 239,
                         'might': 568,
                         'office': 619,
                         'two': 920,
                         'through': 885,
                         'town': 900,
                         'news': 605,
                         'local': 519,
                         'been': 86,
                         'stolen': 823,
                         'form': 334,
                         'men': 562,
                         'determined': 226,
                         'gay': 353,
                         'night': 608,
                         'west': 958,
                         'hollywood': 412,
                         'california': 135,
                         'eddie': 261,
                         'friends': 344,
                         'going': 370,
                         'following': 325,
                         'encounter': 266,
                         'sets': 774,
                         'eye': 290,
                         'jake': 452,
                         'bad': 74,
                         'wants': 946,
                         'better': 98,
                         'very': 938,
                         'you': 997,
                         'their': 869,
                         'adult': 12,
                         'about': 1,
                         'move': 583,
                         'away': 71,
                         'south': 806,
                         'village': 939,
                         'entire': 273,
                         'up': 929,
                         'which': 964,
                         'were': 957,
                         'area': 52,
                         'yet': 995,
                         'five': 322,
                         'brothers': 127,
                         'being': 92,
                         'only': 627,
                         'between': 99,
                         'also': 34,
                         'within': 979,
                         'family': 297,
                         'its': 449,
                         'members': 561,
                         'different': 231,
                         'role': 734,
                         'age': 18,
                         'immediately': 429,
                         'marry': 548,
                         'brother': 126,
                         'front': 347,
                         'sister': 792,
                         'mr': 586,
                         'relationship': 712,
                         'would': 989,
                         'did': 227,
                         'book': 114,
                         'first': 321,
                         'experience': 289,
                         'school': 751,
                         'result': 721,
                         'whose': 970,
                         'leave': 502,
                         'now': 613,
                         'even': 279,
                         'worse': 988,
                         'want': 944,
                         'something': 803,
                         'frank': 340,
                         'marriage': 546,
                         'puts': 691,
                         'middle': 567,
                         'roy': 739,
                         'was': 948,
                         'raised': 698,
                         'best': 97,
                         'world': 987,
                         'early': 257,
                         'fellow': 307,
                         'some': 801,
                         'leaves': 503,
                         'hand': 380,
                         'let': 509,
                         'down': 245,
                         'gets': 358,
                         'becomes': 84,
                         'really': 706,
                         'farm': 300,
                         'convinces': 185,
                         'll': 518,
                         'ever': 282,
                         'seen': 765,
                         'agrees': 22,
                         'go': 366,
                         'road': 730,
                         'actually': 10,
                         'finds': 319,
                         'outside': 636,
                         'quite': 696,
                         'soon': 805,
                         'cross': 197,
                         'still': 822,
                         'top': 897,
                         'have': 388,
                         'huge': 422,
                         'both': 117,
                         'off': 616,
                         'truly': 911,
                         'these': 874,
                         'help': 396,
                         'buddy': 129,
                         'survive': 843,
                         'during': 254,
                         'adventure': 13,
                         'why': 971,
                         'always': 36,
                         'plans': 659,
                         'summer': 840,
                         'good': 372,
                         'ed': 260,
                         'car': 143,
                         'accident': 3,
                         'teacher': 854,
                         'put': 690,
                         'job': 460,
                         'helps': 397,
                         'across': 5,
                         'business': 131,
                         'makes': 540,
                         'under': 923,
                         'what': 959,
                         'home': 413,
                         'break': 121,
                         'steal': 820,
                         'drive': 249,
                         'idea': 426,
                         'whole': 968,
                         'so': 797,
                         'owner': 639,
                         'jail': 451,
                         'using': 935,
                         'everything': 285,
                         'living': 517,
                         'stand': 812,
                         'kind': 479,
                         'guy': 377,
                         'neighbor': 601,
                         'mrs': 587,
                         'can': 140,
                         'keeps': 470,
                         'playing': 662,
                         'winning': 977,
                         'big': 101,
                         'last': 490,
                         'taking': 851,
                         'girlfriend': 361,
                         'loves': 534,
                         'little': 514,
                         'alone': 31,
                         'whatever': 960,
                         'named': 596,
                         'million': 571,
                         'having': 389,
                         'set': 773,
                         'own': 638,
                         'time': 887,
                         'behavior': 90,
                         'leads': 499,
                         'believe': 93,
                         'may': 554,
                         'appears': 50,
                         'especially': 276,
                         'police': 666,
                         'neighborhood': 602,
                         'suspect': 846,
                         'nature': 597,
                         'others': 633,
                         'san': 746,
                         'herself': 401,
                         'powers': 673,
                         'lead': 496,
                         'same': 745,
                         'jack': 450,
                         'actor': 8,
                         'track': 901,
                         'beloved': 95,
                         'situation': 793,
                         'comedy': 176,
                         're': 701,
                         'fate': 301,
                         'runs': 742,
                         'attracted': 69,
                         'elizabeth': 263,
                         'tv': 918,
                         'could': 188,
                         'play': 660,
                         'series': 771,
                         'taken': 849,
                         'seeing': 760,
                         'whom': 969,
                         'turns': 917,
                         'right': 728,
                         'ways': 951,
                         'got': 373,
                         'name': 595,
                         'stop': 824,
                         'young': 998,
                         'boys': 120,
                         'attention': 68,
                         'decide': 217,
                         'bank': 76,
                         'more': 579,
                         'great': 375,
                         'win': 976,
                         'girls': 362,
                         'over': 637,
                         'girl': 360,
                         'women': 982,
                         'must': 593,
                         'american': 38,
                         'football': 328,
                         'wealthy': 953,
                         'calls': 138,
                         'since': 789,
                         'real': 702,
                         'truth': 912,
                         'working': 985,
                         'mob': 576,
                         'teen': 857,
                         'daughter': 206,
                         'mother': 582,
                         'law': 494,
                         'because': 82,
                         'fbi': 303,
                         'killed': 475,
                         'turn': 915,
                         'kid': 471,
                         'strange': 828,
                         'white': 966,
                         'kids': 473,
                         'ex': 288,
                         'learns': 501,
                         'kidnapped': 472,
                         'come': 175,
                         'plan': 656,
                         'how': 420,
                         'themselves': 871,
                         'easy': 259,
                         'mind': 572,
                         'includes': 432,
                         'case': 146,
                         'knows': 484,
                         'those': 881,
                         'cia': 164,
                         'begins': 89,
                         'london': 520,
                         'shot': 784,
                         'ten': 863,
                         'years': 994,
                         'russian': 743,
                         'thinks': 879,
                         'should': 785,
                         'told': 891,
                         'tell': 860,
                         'anyone': 47,
                         'including': 433,
                         'someone': 802,
                         'instead': 437,
                         'kills': 478,
                         'says': 749,
                         'bring': 123,
                         'fiancée': 310,
                         'along': 32,
                         'shows': 787,
                         'doesn': 240,
                         'action': 7,
                         'forces': 332,
                         'place': 655,
                         'aunt': 70,
                         'finally': 316,
                         'each': 256,
                         'order': 631,
                         'country': 189,
                         'prince': 677,
                         'unfortunately': 924,
                         'red': 710,
                         'well': 956,
                         'among': 39,
                         'mysterious': 594,
                         'british': 125,
                         'human': 423,
                         'race': 697,
                         'group': 376,
                         'heads': 392,
                         'die': 228,
                         'or': 630,
                         'music': 592,
                         'scene': 750,
                         'alice': 26,
                         'band': 75,
                         'black': 105,
                         'writer': 990,
                         'century': 150,
                         'francisco': 339,
                         'doing': 242,
                         'every': 283,
                         'brought': 128,
                         'we': 952,
                         'enough': 272,
                         'thing': 876,
                         'anything': 48,
                         'husband': 425,
                         'children': 161,
                         'uncle': 922,
                         'chris': 162,
                         'difficult': 232,
                         'any': 46,
                         'although': 35,
                         'care': 144,
                         'deal': 214,
                         'hired': 406,
                         'full': 348,
                         'support': 841,
                         'latest': 493,
                         'attempt': 66,
                         'private': 680,
                         'killing': 477,
                         'larry': 489,
                         'receives': 708,
                         'returns': 723,
                         'trouble': 909,
                         'th': 865,
                         'military': 570,
                         'special': 808,
                         'team': 855,
                         'led': 505,
                         'officer': 620,
                         'mission': 575,
                         'travel': 903,
                         'left': 507,
                         'former': 335,
                         'quickly': 695,
                         'discovers': 235,
                         'long': 522,
                         'tommy': 893,
                         'manager': 543,
                         'investigate': 440,
                         'face': 292,
                         'fight': 311,
                         'rocky': 733,
                         'billy': 103,
                         'boat': 109,
                         'captain': 142,
                         'crew': 194,
                         'join': 464,
                         'bobby': 111,
                         'recently': 709,
                         'met': 564,
                         'behind': 91,
                         'lose': 528,
                         'future': 350,
                         'another': 45,
                         'slowly': 795,
                         'few': 309,
                         'try': 913,
                         'seemingly': 763,
                         'game': 351,
                         'pregnant': 674,
                         'older': 623,
                         'player': 661,
                         'side': 788,
                         'missing': 574,
                         'student': 833,
                         'realize': 704,
                         'dark': 204,
                         'de': 211,
                         'released': 714,
                         'prison': 679,
                         'dog': 241,
                         'ben': 96,
                         'found': 337,
                         'things': 877,
                         'seem': 762,
                         'start': 814,
                         'department': 220,
                         'protect': 687,
                         'daniel': 202,
                         'finding': 318,
                         'hard': 385,
                         'beautiful': 81,
                         'gang': 352,
                         'hell': 395,
                         'further': 349,
                         'spirit': 810,
                         'show': 786,
                         'around': 54,
                         'high': 403,
                         'power': 671,
                         'deep': 219,
                         'forever': 333,
                         'knowing': 482,
                         'teenager': 859,
                         'hands': 381,
                         'several': 776,
                         'number': 614,
                         'assigned': 62,
                         'investigation': 441,
                         'call': 136,
                         'doctor': 237,
                         'building': 130,
                         'follows': 326,
                         'wedding': 954,
                         'issues': 447,
                         'coming': 178,
                         'dr': 246,
                         'caught': 148,
                         'crime': 195,
                         'mental': 563,
                         'important': 430,
                         'seems': 764,
                         'starts': 815,
                         'murders': 591,
                         'true': 910,
                         'control': 183,
                         'chicago': 157,
                         'looks': 525,
                         'ago': 21,
                         'affair': 14,
                         'follow': 324,
                         'realizes': 705,
                         'trip': 908,
                         'jim': 458,
                         'parents': 640,
                         'criminal': 196,
                         'running': 741,
                         'line': 513,
                         'eventually': 281,
                         'refuses': 711,
                         'becoming': 85,
                         'ultimately': 921,
                         'thought': 883,
                         'identity': 427,
                         'late': 491,
                         'university': 926,
                         'such': 837,
                         'lover': 533,
                         'england': 270,
                         'battle': 79,
                         'cause': 149,
                         'dangerous': 201,
                         'child': 159,
                         'called': 137,
                         'travels': 905,
                         'search': 754,
                         'gold': 371,
                         'camp': 139,
                         'danger': 200,
                         'land': 486,
                         'sheriff': 781,
                         'past': 646,
                         'us': 931,
                         'project': 686,
                         'many': 544,
                         'final': 315,
                         'large': 487,
                         'due': 253,
                         'van': 937,
                         'fire': 320,
                         'earth': 258,
                         'states': 817,
                         'days': 210,
                         'scientist': 752,
                         'government': 374,
                         'lee': 506,
                         'susan': 845,
                         'research': 718,
                         'god': 368,
                         'boss': 116,
                         'destroy': 224,
                         'paul': 647,
                         'paris': 641,
                         'french': 342,
                         'flight': 323,
                         'cold': 172,
                         'self': 767,
                         'else': 265,
                         'second': 755,
                         'director': 233,
                         'english': 271,
                         'sex': 777,
                         'leading': 498,
                         'actress': 9,
                         'plays': 663,
                         'process': 683,
                         'change': 152,
                         'professional': 684,
                         'personal': 652,
                         'professor': 685,
                         'wanted': 945,
                         'need': 599,
                         'reason': 707,
                         'revenge': 724,
                         'thus': 886,
                         'richard': 726,
                         'made': 536,
                         'interest': 438,
                         'mexico': 565,
                         'texas': 864,
                         'fall': 294,
                         'kate': 468,
                         'state': 816,
                         'hospital': 416,
                         'secret': 756,
                         'involved': 443,
                         'romantic': 736,
                         'feelings': 305,
                         'queen': 692,
                         'army': 53,
                         'ray': 700,
                         'danny': 203,
                         'twenty': 919,
                         'anna': 44,
                         'already': 33,
                         'bill': 102,
                         'prove': 688,
                         'reality': 703,
                         'suicide': 839,
                         'based': 78,
                         'upon': 930,
                         'unknown': 927,
                         'art': 58,
                         'north': 610,
                         'boyfriend': 119,
                         'nothing': 612,
                         'given': 364,
                         'months': 578,
                         'live': 515,
                         'pay': 648,
                         'childhood': 160,
                         'war': 947,
                         'seeks': 761,
                         'door': 244,
                         'inside': 436,
                         'contact': 182,
                         'half': 379,
                         'problem': 681,
                         'king': 480,
                         'dream': 247,
                         'return': 722,
                         'hires': 407,
                         'isn': 446,
                         'loses': 529,
                         'agent': 19,
                         'known': 483,
                         'america': 37,
                         'keep': 469,
                         'looking': 524,
                         'blue': 107,
                         'wild': 973,
                         'traveling': 904,
                         'younger': 999,
                         'brings': 124,
                         'together': 890,
                         'cannot': 141,
                         'forced': 331,
                         'major': 538,
                         'max': 553,
                         'asks': 61,
                         'invites': 442,
                         'visit': 942,
                         'times': 888,
                         'ellen': 264,
                         'alien': 27,
                         'attack': 65,
                         'far': 299,
                         'lost': 530,
                         'tough': 898,
                         'space': 807,
                         'class': 166,
                         'teenage': 858,
                         'feels': 306,
                         'estate': 277,
                         'buy': 133,
                         'rich': 725,
                         'vacation': 936,
                         'stranger': 829,
                         'bar': 77,
                         'short': 783,
                         'johnny': 463,
                         'helen': 394,
                         'less': 508,
                         'happy': 384,
                         'hotel': 417,
                         'detective': 225,
                         'john': 462,
                         'dealer': 215,
                         'sure': 842,
                         'talk': 853,
                         'arrested': 55,
                         'telling': 861,
                         'goal': 367,
                         'heart': 393,
                         'won': 983,
                         'lucy': 535,
                         'used': 933,
                         'eve': 278,
                         'tom': 892,
                         'toward': 899,
                         'perfect': 650,
                         'alex': 25,
                         'hit': 410,
                         'ann': 43,
                         'island': 445,
                         'sam': 744,
                         'master': 551,
                         'system': 847,
                         'current': 198,
                         'social': 798,
                         'quest': 693,
                         'hope': 414,
                         'coach': 171,
                         'college': 173,
                         'leader': 497,
                         'violence': 940,
                         'journey': 466,
                         'documentary': 238,
                         'point': 665,
                         'rock': 732,
                         'jimmy': 459,
                         'jeff': 456,
                         'clear': 167,
                         'writing': 991,
                         'couple': 190,
                         'streets': 831,
                         'bond': 113,
                         'relationships': 713,
                         'cop': 186,
                         'desert': 221,
                         'tale': 852,
                         'everyone': 284,
                         'sent': 770,
                         'soldiers': 800,
                         'princess': 678,
                         'suddenly': 838,
                         'think': 878,
                         'too': 895,
                         'romance': 735,
                         'escape': 274,
                         'breaks': 122,
                         'evidence': 286,
                         'ride': 727,
                         'mike': 569,
                         'club': 169,
                         'violent': 941,
                         'joe': 461,
                         'blood': 106,
                         'part': 643,
                         'escapes': 275,
                         'friendship': 345,
                         'star': 813,
                         'drugs': 252,
                         'gives': 365,
                         'hours': 418,
                         'dreams': 248,
                         'figure': 313,
                         'computer': 181,
                         'rescue': 717,
                         'lord': 526,
                         'often': 621,
                         'miss': 573,
                         'adam': 11,
                         'singer': 790,
                         'popular': 668,
                         'uses': 934,
                         'co': 170,
                         'ted': 856,
                         'events': 280,
                         'peter': 654,
                         'henry': 398,
                         'hunter': 424,
                         'plane': 657,
                         'open': 628,
                         'steve': 821,
                         'party': 645,
                         'stage': 811,
                         'trial': 906,
                         'wrong': 992,
                         'famous': 298,
                         'stories': 826,
                         'once': 625,
                         'took': 896,
                         'successful': 836,
                         'deadly': 213,
                         'mark': 545,
                         'question': 694,
                         'success': 835,
                         'public': 689,
                         'alive': 28,
                         'park': 642,
                         'free': 341,
                         'problems': 682,
                         'course': 191,
                         'hero': 400,
                         'cat': 147,
                         'harry': 386,
                         'attempts': 67,
                         'mary': 550,
                         'security': 758,
                         'lot': 531,
                         'arrives': 57,
                         'birthday': 104,
                         'reporter': 716,
                         'act': 6,
                         'assistant': 63,
                         'history': 409,
                         'opportunity': 629,
                         'rival': 729,
                         'innocent': 435,
                         'corrupt': 187,
                         'almost': 30,
                         'united': 925,
                         'air': 23,
                         'service': 772,
                         'dance': 199,
                         'lady': 485,
                         'turned': 916,
                         'students': 834,
                         'characters': 154,
                         'born': 115,
                         'lonely': 521,
                         'desperate': 222,
                         'eyes': 291,
                         'driver': 250,
                         'court': 192,
                         'charles': 155,
                         'enemy': 269,
                         'david': 208,
                         'alan': 24,
                         'general': 354,
                         'whether': 963,
                         'society': 799,
                         'agents': 20,
                         'matt': 552,
                         'struggling': 832,
                         'falling': 295,
                         'station': 818,
                         'force': 330,
                         'artist': 59,
                         'fighting': 312,
                         'jane': 454,
                         'spend': 809,
                         'christmas': 163,
                         'nick': 607,
                         'share': 779,
                         'joins': 465,
                         'hidden': 402,
                         'either': 262,
                         'our': 634,
                         'community': 179,
                         'jerry': 457,
                         'water': 949,
                         'feel': 304,
                         'moves': 584,
                         'political': 667,
                         'dying': 255,
                         'pete': 653,
                         'light': 511,
                         'rest': 720,
                         'james': 453,
                         'sarah': 747,
                         'offer': 617,
                         'partner': 644,
                         'tony': 894,
                         'begin': 88,
                         'plot': 664,
                         'planet': 658,
                         'colonel': 174,
                         'hold': 411,
                         'hopes': 415,
                         'german': 356,
                         'survivors': 844,
                         'largely': 488,
                         'present': 675,
                         'rose': 738,
                         'william': 975,
                         'dave': 207,
                         'food': 327,
                         'sexual': 778,
                         'weekend': 955,
                         'bob': 110,
                         'remote': 715,
                         'charlie': 156,
                         'crash': 193,
                         'japanese': 455,
                         'maggie': 537,
                         'scott': 753}
    
    
    d = {'plot': [plot]}
    df = pd.DataFrame(data=d)
    
    prueba = df.loc[:, 'plot']
    
    XTest = vect.transform(prueba)
    

    cols = ['p_Action', 'p_Adventure', 'p_Animation', 'p_Biography', 'p_Comedy', 'p_Crime', 'p_Documentary', 'p_Drama', 'p_Family',
        'p_Fantasy', 'p_Film-Noir', 'p_History', 'p_Horror', 'p_Music', 'p_Musical', 'p_Mystery', 'p_News', 'p_Romance',
        'p_Sci-Fi', 'p_Short', 'p_Sport', 'p_Thriller', 'p_War', 'p_Western']

    # Make prediction
    p1 = clf.predict(XTest)
    p1_df = pd.DataFrame(p1 ,columns=cols)
    
    cadena = ""
    
    for i in p1_df.columns:
        if p1_df[i][0]==1:
            cadena = cadena + i + " "

    return cadena


if __name__ == "__main__":
    
    if len(sys.argv) == 0:
        print('Por favor ingrese la sinopsis de la película')
        
    else:

        plot = sys.argv[1]
 

        p1 = predict_genres(plot)
        
        print('Géneros de la película: ', p1)