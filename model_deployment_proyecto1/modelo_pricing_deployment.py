#!/usr/bin/python

import pandas as pd
import joblib
import sys
import os
from sklearn.preprocessing import LabelEncoder
from sklearn.ensemble import RandomForestRegressor

def predict_price(year, mileage, state, make, model):
    
    clf = joblib.load(os.path.dirname(__file__) + '/pricing_clf.pkl') 
  
    # Tratamiento de Categ√≥ricas
    d1 = dict({"AK": 0, "AL": 1, "AR": 2, "AZ": 3, "CA": 4, "CO": 5, "CT": 6, "DC": 7, "DE": 8, "FL": 9, "GA": 10, "HI": 11, "IA": 12, "ID": 13, "IL": 14, "IN": 15, "KS": 16, "KY": 17, "LA": 18, "MA": 19, "MD": 20, "ME": 21, "MI": 22, "MN": 23, "MO": 24, "MS": 25, "MT": 26, "NC": 27, "ND": 28, "NE": 29, "NH": 30, "NJ": 31, "NM": 32, "NV": 33, "NY": 34, "OH": 35, "OK": 36, "OR": 37, "PA": 38, "RI": 39, "SC": 40, "SD": 41, "TN": 42, "TX": 43, "UT": 44, "VA": 45, "VT": 46, "WA": 47, "WI": 48, "WV": 49, "WY": 50}
)
    d2 = dict({"Acura": 0, "Audi": 1, "BMW": 2, "Bentley": 3, "Buick": 4, "Cadillac": 5, "Chevrolet": 6, "Chrysler": 7, "Dodge": 8, "FIAT": 9, "Ford": 10, "Freightliner": 11, "GMC": 12, "Honda": 13, "Hyundai": 14, "INFINITI": 15, "Jaguar": 16, "Jeep": 17, "Kia": 18, "Land": 19, "Lexus": 20, "Lincoln": 21, "MINI": 22, "Mazda": 23, "Mercedes-Benz": 24, "Mercury": 25, "Mitsubishi": 26, "Nissan": 27, "Pontiac": 28, "Porsche": 29, "Ram": 30, "Scion": 31, "Subaru": 32, "Suzuki": 33, "Tesla": 34, "Toyota": 35, "Volkswagen": 36, "Volvo": 37}
)
    
    d3 = dict({"1": 0, "15002WD": 1, "15004WD": 2, "1500Laramie": 3, "1500Tradesman": 4, "200LX": 5, "200Limited": 6, "200S": 7, "200Touring": 8, "25002WD": 9, "25004WD": 10, "3": 11, "300300C": 12, "300300S": 13, "3004dr": 14, "300Base": 15, "300Limited": 16, "300Touring": 17, "35004WD": 18, "350Z2dr": 19, "4Runner2WD": 20, "4Runner4WD": 21, "4Runner4dr": 22, "4RunnerLimited": 23, "4RunnerRWD": 24, "4RunnerSR5": 25, "4RunnerTrail": 26, "5": 27, "500Pop": 28, "6": 29, "7": 30, "911": 31, "9112dr": 32, "A34dr": 33, "A44dr": 34, "A64dr": 35, "A8": 36, "AcadiaAWD": 37, "AcadiaFWD": 38, "Accent4dr": 39, "Accord": 40, "AccordEX": 41, "AccordEX-L": 42, "AccordLX": 43, "AccordLX-S": 44, "AccordSE": 45, "Altima4dr": 46, "Armada2WD": 47, "Armada4WD": 48, "Avalanche2WD": 49, "Avalanche4WD": 50, "Avalon4dr": 51, "AvalonLimited": 52, "AvalonTouring": 53, "AvalonXLE": 54, "Azera4dr": 55, "Boxster2dr": 56, "C-Class4dr": 57, "C-ClassC": 58, "C-ClassC300": 59, "C-ClassC350": 60, "C702dr": 61, "CC4dr": 62, "CR-V2WD": 63, "CR-V4WD": 64, "CR-VEX": 65, "CR-VEX-L": 66, "CR-VLX": 67, "CR-VSE": 68, "CR-ZEX": 69, "CT": 70, "CTCT": 71, "CTS": 72, "CTS-V": 73, "CTS4dr": 74, "CX-7FWD": 75, "CX-9AWD": 76, "CX-9FWD": 77, "CX-9Grand": 78, "CX-9Touring": 79, "Caliber4dr": 80, "Camaro2dr": 81, "CamaroConvertible": 82, "CamaroCoupe": 83, "Camry": 84, "Camry4dr": 85, "CamryBase": 86, "CamryL": 87, "CamryLE": 88, "CamrySE": 89, "CamryXLE": 90, "Canyon2WD": 91, "Canyon4WD": 92, "CanyonCrew": 93, "CanyonExtended": 94, "CayenneAWD": 95, "Cayman2dr": 96, "Challenger2dr": 97, "ChallengerR/T": 98, "Charger4dr": 99, "ChargerSE": 100, "ChargerSXT": 101, "CherokeeLimited": 102, "CherokeeSport": 103, "Civic": 104, "CivicEX": 105, "CivicEX-L": 106, "CivicLX": 107, "CivicSi": 108, "Cobalt2dr": 109, "Cobalt4dr": 110, "Colorado2WD": 111, "Colorado4WD": 112, "ColoradoCrew": 113, "ColoradoExtended": 114, "Compass4WD": 115, "CompassLatitude": 116, "CompassLimited": 117, "CompassSport": 118, "Continental": 119, "Cooper": 120, "Corolla4dr": 121, "CorollaL": 122, "CorollaLE": 123, "CorollaS": 124, "Corvette2dr": 125, "CorvetteConvertible": 126, "CorvetteCoupe": 127, "CruzeLT": 128, "CruzeSedan": 129, "DTS4dr": 130, "Dakota2WD": 131, "Dakota4WD": 132, "Durango2WD": 133, "Durango4dr": 134, "DurangoAWD": 135, "DurangoSXT": 136, "E-ClassE": 137, "E-ClassE320": 138, "E-ClassE350": 139, "ES": 140, "ESES": 141, "Eclipse3dr": 142, "Econoline": 143, "EdgeLimited": 144, "EdgeSE": 145, "EdgeSEL": 146, "EdgeSport": 147, "Elantra": 148, "Elantra4dr": 149, "ElantraLimited": 150, "Element2WD": 151, "Element4WD": 152, "EnclaveConvenience": 153, "EnclaveLeather": 154, "EnclavePremium": 155, "Eos2dr": 156, "EquinoxAWD": 157, "EquinoxFWD": 158, "Escalade": 159, "Escalade2WD": 160, "Escalade4dr": 161, "EscaladeAWD": 162, "Escape4WD": 163, "Escape4dr": 164, "EscapeFWD": 165, "EscapeLImited": 166, "EscapeLimited": 167, "EscapeS": 168, "EscapeSE": 169, "EscapeXLT": 170, "Excursion137": 171, "Expedition": 172, "Expedition2WD": 173, "Expedition4WD": 174, "ExpeditionLimited": 175, "ExpeditionXLT": 176, "Explorer": 177, "Explorer4WD": 178, "Explorer4dr": 179, "ExplorerBase": 180, "ExplorerEddie": 181, "ExplorerFWD": 182, "ExplorerLimited": 183, "ExplorerXLT": 184, "Express": 185, "F-1502WD": 186, "F-1504WD": 187, "F-150FX2": 188, "F-150FX4": 189, "F-150King": 190, "F-150Lariat": 191, "F-150Limited": 192, "F-150Platinum": 193, "F-150STX": 194, "F-150SuperCrew": 195, "F-150XL": 196, "F-150XLT": 197, "F-250King": 198, "F-250Lariat": 199, "F-250XL": 200, "F-250XLT": 201, "F-350King": 202, "F-350Lariat": 203, "F-350XL": 204, "F-350XLT": 205, "FJ": 206, "FX35AWD": 207, "FiestaS": 208, "FiestaSE": 209, "FitSport": 210, "FlexLimited": 211, "FlexSE": 212, "FlexSEL": 213, "Focus4dr": 214, "Focus5dr": 215, "FocusS": 216, "FocusSE": 217, "FocusSEL": 218, "FocusST": 219, "FocusTitanium": 220, "Forester2.5X": 221, "Forester4dr": 222, "Forte": 223, "ForteEX": 224, "ForteLX": 225, "ForteSX": 226, "Frontier": 227, "Frontier2WD": 228, "Frontier4WD": 229, "Fusion4dr": 230, "FusionHybrid": 231, "FusionS": 232, "FusionSE": 233, "FusionSEL": 234, "G35": 235, "G37": 236, "G64dr": 237, "GLI4dr": 238, "GS": 239, "GSGS": 240, "GTI2dr": 241, "GTI4dr": 242, "GX": 243, "GXGX": 244, "Galant4dr": 245, "Genesis": 246, "Golf": 247, "Grand": 248, "Highlander": 249, "Highlander4WD": 250, "Highlander4dr": 251, "HighlanderBase": 252, "HighlanderFWD": 253, "HighlanderLimited": 254, "HighlanderSE": 255, "IS": 256, "ISIS": 257, "Impala4dr": 258, "ImpalaLS": 259, "ImpalaLT": 260, "Impreza": 261, "Impreza2.0i": 262, "ImprezaSport": 263, "Jetta": 264, "JourneyAWD": 265, "JourneyFWD": 266, "JourneySXT": 267, "LS": 268, "LSLS": 269, "LX": 270, "LXLX": 271, "LaCrosse4dr": 272, "LaCrosseAWD": 273, "LaCrosseFWD": 274, "Lancer4dr": 275, "Land": 276, "Legacy": 277, "Legacy2.5i": 278, "Legacy3.6R": 279, "Liberty4WD": 280, "LibertyLimited": 281, "LibertySport": 282, "Lucerne4dr": 283, "M-ClassML350": 284, "MDX4WD": 285, "MDXAWD": 286, "MKXAWD": 287, "MKXFWD": 288, "MKZ4dr": 289, "MX5": 290, "Malibu": 291, "Malibu1LT": 292, "Malibu4dr": 293, "MalibuLS": 294, "MalibuLT": 295, "Matrix5dr": 296, "Maxima4dr": 297, "Mazda34dr": 298, "Mazda35dr": 299, "Mazda64dr": 300, "Milan4dr": 301, "Model": 302, "Monte": 303, "Murano2WD": 304, "MuranoAWD": 305, "MuranoS": 306, "Mustang2dr": 307, "MustangBase": 308, "MustangDeluxe": 309, "MustangGT": 310, "MustangPremium": 311, "MustangShelby": 312, "Navigator": 313, "Navigator2WD": 314, "Navigator4WD": 315, "Navigator4dr": 316, "New": 317, "OdysseyEX": 318, "OdysseyEX-L": 319, "OdysseyLX": 320, "OdysseyTouring": 321, "Optima4dr": 322, "OptimaEX": 323, "OptimaLX": 324, "OptimaSX": 325, "Outback2.5i": 326, "Outback3.6R": 327, "Outlander": 328, "Outlander2WD": 329, "Outlander4WD": 330, "PT": 331, "PacificaLimited": 332, "PacificaTouring": 333, "Passat": 334, "Passat4dr": 335, "Pathfinder2WD": 336, "Pathfinder4WD": 337, "PathfinderS": 338, "PathfinderSE": 339, "Patriot4WD": 340, "PatriotLatitude": 341, "PatriotLimited": 342, "PatriotSport": 343, "Pilot2WD": 344, "Pilot4WD": 345, "PilotEX": 346, "PilotEX-L": 347, "PilotLX": 348, "PilotSE": 349, "PilotTouring": 350, "Prius": 351, "Prius5dr": 352, "PriusBase": 353, "PriusFive": 354, "PriusFour": 355, "PriusOne": 356, "PriusThree": 357, "PriusTwo": 358, "Q5quattro": 359, "Q7quattro": 360, "QX562WD": 361, "QX564WD": 362, "Quest4dr": 363, "RAV4": 364, "RAV44WD": 365, "RAV44dr": 366, "RAV4Base": 367, "RAV4FWD": 368, "RAV4LE": 369, "RAV4Limited": 370, "RAV4Sport": 371, "RAV4XLE": 372, "RDXAWD": 373, "RDXFWD": 374, "RX": 375, "RX-84dr": 376, "RXRX": 377, "Ram": 378, "Ranger2WD": 379, "Ranger4WD": 380, "RangerSuperCab": 381, "Regal4dr": 382, "RegalGS": 383, "RegalPremium": 384, "RegalTurbo": 385, "RidgelineRTL": 386, "RidgelineSport": 387, "RioLX": 388, "RogueFWD": 389, "Rover": 390, "S2000Manual": 391, "S44dr": 392, "S60T5": 393, "S804dr": 394, "SC": 395, "SL-ClassSL500": 396, "SLK-ClassSLK350": 397, "SRXLuxury": 398, "STS4dr": 399, "Santa": 400, "Savana": 401, "Sedona4dr": 402, "SedonaEX": 403, "SedonaLX": 404, "Sentra4dr": 405, "Sequoia4WD": 406, "Sequoia4dr": 407, "SequoiaLimited": 408, "SequoiaPlatinum": 409, "SequoiaSR5": 410, "Sienna5dr": 411, "SiennaLE": 412, "SiennaLimited": 413, "SiennaSE": 414, "SiennaXLE": 415, "Sierra": 416, "Silverado": 417, "Sonata4dr": 418, "SonataLimited": 419, "SonataSE": 420, "SonicHatch": 421, "SonicSedan": 422, "Sorento2WD": 423, "SorentoEX": 424, "SorentoLX": 425, "SorentoSX": 426, "Soul+": 427, "SoulBase": 428, "Sportage2WD": 429, "SportageAWD": 430, "SportageEX": 431, "SportageLX": 432, "SportageSX": 433, "Sprinter": 434, "Suburban2WD": 435, "Suburban4WD": 436, "Suburban4dr": 437, "Super": 438, "TL4dr": 439, "TLAutomatic": 440, "TSXAutomatic": 441, "TT2dr": 442, "Tacoma2WD": 443, "Tacoma4WD": 444, "TacomaBase": 445, "TacomaPreRunner": 446, "Tahoe2WD": 447, "Tahoe4WD": 448, "Tahoe4dr": 449, "TahoeLS": 450, "TahoeLT": 451, "Taurus4dr": 452, "TaurusLimited": 453, "TaurusSE": 454, "TaurusSEL": 455, "TaurusSHO": 456, "TerrainAWD": 457, "TerrainFWD": 458, "Tiguan2WD": 459, "TiguanS": 460, "TiguanSE": 461, "TiguanSEL": 462, "Titan": 463, "Titan2WD": 464, "Titan4WD": 465, "Touareg4dr": 466, "Town": 467, "Transit": 468, "TraverseAWD": 469, "TraverseFWD": 470, "TucsonAWD": 471, "TucsonFWD": 472, "TucsonLimited": 473, "Tundra": 474, "Tundra2WD": 475, "Tundra4WD": 476, "TundraBase": 477, "TundraLimited": 478, "TundraSR5": 479, "VeracruzAWD": 480, "VeracruzFWD": 481, "Versa4dr": 482, "Versa5dr": 483, "Vibe4dr": 484, "WRXBase": 485, "WRXLimited": 486, "WRXPremium": 487, "WRXSTI": 488, "Wrangler": 489, "Wrangler2dr": 490, "Wrangler4WD": 491, "WranglerRubicon": 492, "WranglerSahara": 493, "WranglerSport": 494, "WranglerX": 495, "X1xDrive28i": 496, "X3AWD": 497, "X3xDrive28i": 498, "X5AWD": 499, "X5xDrive35i": 500, "XC60AWD": 501, "XC60FWD": 502, "XC60T6": 503, "XC704dr": 504, "XC90AWD": 505, "XC90FWD": 506, "XC90T6": 507, "XF4dr": 508, "XJ4dr": 509, "XK2dr": 510, "Xterra2WD": 511, "Xterra4WD": 512, "Xterra4dr": 513, "Yaris": 514, "Yaris4dr": 515, "YarisBase": 516, "YarisLE": 517, "Yukon": 518, "Yukon2WD": 519, "Yukon4WD": 520, "Yukon4dr": 521, "tC2dr": 522, "xB5dr": 523, "xD5dr": 524}
)
    
    state2 = d1[state]
    make2 = d2[make]
    model2 = d3[model]
               
               
    data = [[year,mileage,state2,make2,model2]]

    df = pd.DataFrame(data, columns=['Year', 'Mileage', 'State', 'Make', 'Model'])
    
    

    # Make prediction
    p1 = clf.predict(df)

    return p1


if __name__ == "__main__":
    
    if len(sys.argv) == 1:
        print('Por favor ingrese los valores solicitados')
        
    else:

        year = sys.argv[1]
        mileage = sys.argv[2]
        state = sys.argv[3]
        make = sys.argv[4]
        model = sys.argv[5]

        p1 = predict_price(year, mileage, state, make, model)
        
        print('Precio del vehiculo: ', p1)